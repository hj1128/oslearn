%MACRO INITREG 0
    MOV  AX,CS
    MOV  ES,AX
    MOV  SS,AX
    MOV  DS,AX
    MOV  FS,AX
%ENDMACRO

%MACRO  INITDESC 2
      XOR  EAX,EAX
      MOV  AX,CS
      SHL  EAX,4
      ADD  EAX,%1
      MOV  WORD [%2 + 2],AX
      SHR  EAX,10H
      MOV  BYTE [%2 + 4],AL
      MOV  BYTE [%2 + 7],AH
%ENDMACRO

%MACRO  INITGDT 0
      XOR  EAX,EAX
      MOV  AX,CS
      SHL  EAX,4
      ADD  EAX,LABEL_GDT
      MOV  DWORD [GDTPTR + 2],EAX
%ENDMACRO

%MACRO SHOWCHAR 0
      PUSH AX
      MOV  AX,0B800H
      MOV  GS,AX
      POP  AX
      MOV  AH,0CH
      MOV  EDI,[_POSITION]
      MOV  [GS:EDI],AX
      ADD  EDI,2
      MOV  [_POSITION],EDI
%ENDMACRO

%MACRO SHOWRETURN 0
      MOV  EAX,[_POSITION]
      MOV  BL,160
      DIV  BL
      AND  EAX,0FFH
      INC  EAX
      MOV  BL,160
      MUL  BL
      MOV  [_POSITION],EAX
%ENDMACRO

%MACRO SHOWRETURN_P 0
      MOV  EAX,[POSITION]
      MOV  BL,160
      DIV  BL
      AND  EAX,0FFH
      INC  EAX
      MOV  BL,160
      MUL  BL
      MOV  [POSITION],EAX
%ENDMACRO

%MACRO SHOWEAX_HEX 0
      PUSH EAX
      SHR  EAX,16
      CALL SHOWAX_HEX
      POP  EAX
      AND  EAX,0000FFFFH
      CALL SHOWAX_HEX
      MOV  AL,'H'
      SHOWCHAR
      MOV  AL,' '
      SHOWCHAR
%ENDMACRO
%MACRO SHOWEAX_HEX_P 0
      PUSH EAX
      SHR  EAX,16
      CALL SHOWAX_HEX_P
      POP  EAX
      AND  EAX,0000FFFFH
      CALL SHOWAX_HEX_P
      MOV  AL,'H'
      CALL SHOWCHAR_P
      MOV  AL,' '
      CALL SHOWCHAR_P
%ENDMACRO
