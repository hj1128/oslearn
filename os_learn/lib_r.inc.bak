SHOWAL_LOW_HEX:
      AND  AX,000FH
      CMP  AX,9
      JA   .ABOVE9
      ADD  AX,'0'
      JMP  .SHOWCHAR_HEX 
      .ABOVE9:
        SUB  AX,0AH
        ADD  AX,'A'
      .SHOWCHAR_HEX:
        SHOWCHAR
      RET
SHOWAL_HEX:
      PUSH AX
      SHR  AX,4
      CALL SHOWAL_LOW_HEX
      POP  AX
      CALL SHOWAL_LOW_HEX
      RET     
SHOWAX_HEX:
      PUSH AX
      SHR  AX,8
      CALL SHOWAL_HEX
      POP  AX
      AND  AX,00FFH
      CALL SHOWAL_HEX
      RET
SHOWEAX_HEX:
      PUSH EAX
      PUSH EAX
      SHR  EAX,16
      CALL SHOWAX_HEX
      POP  EAX
      AND  EAX,0000FFFFH
      CALL SHOWAX_HEX
      MOV  AL,'H'
      SHOWCHAR
      MOV  AL,' '
      SHOWCHAR
      POP  EAX
      RET

MEMCHK:
      MOV  EBX,0
      MOV  ECX,20
      MOV  DI,_MEMCHKBUF
      .MEMCHKLOOP:
        MOV  EAX,0E820H
	MOV  EDX,534D4150H
        INT  15H
	JC   .MEMCHKFAIL
	ADD  DI,20
	INC  DWORD [_MCRNUMBER]
	CMP  EBX,0
	JNZ  .MEMCHKLOOP
	JMP  .MEMCHKOK
	.MEMCHKFAIL:
	  MOV  DWORD [_MCRNUMBER],0
	.MEMCHKOK:
	  NOP
      RET
DISPMEM:
      MOV  ECX,[_MCRNUMBER]
      MOV  ESI,_MEMCHKBUF
      CLD
      .DISPMEMLOOP:
        MOV  EDI,_ARDSTRUCT
        MOV  EDX,5
        .ARDSTRUCTLOOP:
	  MOV  EAX,[ESI]
	  STOSD                 ;EDI自动增加,对应ES:EDI   LODSD对应DS:ESI
	  CALL SHOWEAX_HEX
	  ADD ESI,4
	  DEC EDX
	  TEST EDX,EDX
	  JZ  .ARDSTRUCTLOOPOK
	  JMP .ARDSTRUCTLOOP
	.ARDSTRUCTLOOPOK:
	  NOP
	  CMP DWORD [_ARDSTRUCTTYPE],1
	  JNE .CHANGELINE
	  MOV EAX,[_BASEADDRLOW]
	  ADD EAX,[_LENGTHLOW]
	  CMP EAX,[_MEMSIZE]
	  JB  .CHANGELINE
	  MOV [_MEMSIZE],EAX
        .CHANGELINE:
          SHOWRETURN
	LOOP  .DISPMEMLOOP
        MOV  EAX,[_MEMSIZE]
	CALL SHOWEAX_HEX
	SHOWRETURN
      RET